<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Superpowers of Money</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin-top: 20px;
    }
    .progress-container {
      width: 80%;
      background: #ddd;
      border-radius: 25px;
      margin: 20px auto;
      overflow: hidden;
    }
    .progress-bar {
      height: 30px;
      background: #4caf50;
      width: 0;
      transition: width 0.3s;
    }
    .progress-text {
      margin-top: 10px;
      font-weight: bold;
    }
    svg {
      width: 80%;
      max-width: 500px;
      margin-top: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>The Superpowers of Money</h1>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div id="progress-fill" class="progress-bar"></div>
  </div>
  <div class="progress-text">0/8 Superpowers Discovered!</div>

  <!-- Pie Chart -->
  <svg viewBox="0 0 32 32">
    <circle r="16" cx="16" cy="16" fill="white"></circle>
    <path d="M16 16 L16 0 A16 16 0 0 1 31.05 8.95 Z" fill="#ff9999" onclick="navigateToDetail('durable')"></path>
    <path d="M16 16 L31.05 8.95 A16 16 0 0 1 25.6 25.6 Z" fill="#66b3ff" onclick="navigateToDetail('portable')"></path>
    <path d="M16 16 L25.6 25.6 A16 16 0 0 1 8.95 31.05 Z" fill="#99ff99" onclick="navigateToDetail('fungible')"></path>
    <path d="M16 16 L8.95 31.05 A16 16 0 0 1 0 16 Z" fill="#ffcc99" onclick="navigateToDetail('verifiable')"></path>
    <path d="M16 16 L0 16 A16 16 0 0 1 8.95 0.95 Z" fill="#c2c2f0" onclick="navigateToDetail('divisible')"></path>
    <path d="M16 16 L8.95 0.95 A16 16 0 0 1 25.6 6.4 Z" fill="#ffb3e6" onclick="navigateToDetail('scarce')"></path>
    <path d="M16 16 L25.6 6.4 A16 16 0 0 1 31.05 8.95 Z" fill="#c2f0c2" onclick="navigateToDetail('history')"></path>
    <path d="M16 16 L31.05 8.95 A16 16 0 0 1 16 0 Z" fill="#f0c2c2" onclick="navigateToDetail('resistance')"></path>
  </svg>

  <!-- Click Sound -->
  <audio id="click-sound" src="click.mp3" preload="auto"></audio>

  <script>
    const attributes = ['durable', 'portable', 'fungible', 'verifiable', 'divisible', 'scarce', 'long-history', 'censorship-resistance'];

    // Reset progress if this load is a real refresh (F5/Reload)
    function resetProgressOnRefresh() {
        var isReload = false;

        // Modern API
        if (performance && performance.getEntriesByType) {
            var nav = performance.getEntriesByType('navigation')[0];
            if (nav && nav.type === 'reload') isReload = true;
        }

        // Fallback for older browsers
        if (!isReload && performance && performance.navigation) {
            isReload = performance.navigation.type === 1; // 1 = reload
        }

        if (isReload) {
            localStorage.removeItem('exploredAttributes'); // start from 0 on refresh
        }
    }

    function updateProgress() {
        const exploredAttributes = JSON.parse(localStorage.getItem('exploredAttributes') || '[]');
        const progress = (exploredAttributes.length / attributes.length) * 100;
        document.getElementById('progress-fill').style.width = `${progress}%`;
        document.querySelector('.progress-text').textContent = `${exploredAttributes.length}/8 Superpowers Discovered!`;
    }

    function navigateToDetail(attr) {
        // Play sound effect
        const clickSound = document.getElementById('click-sound');
        clickSound.play();

        // Update progress in localStorage (only once per attribute, max 8)
        let exploredAttributes = JSON.parse(localStorage.getItem('exploredAttributes') || '[]');
        if (
            exploredAttributes.length < attributes.length &&
            !exploredAttributes.includes(attr)
        ) {
            exploredAttributes.push(attr);
            localStorage.setItem('exploredAttributes', JSON.stringify(exploredAttributes));
        }

        // Navigate to the detail page
        window.location.href = `the-attributes-of-money-${attr}.html`;
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function () {
        resetProgressOnRefresh();
        updateProgress();
    });
  </script>
</body>
</html>

